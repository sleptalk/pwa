<div id="formulario">  
    <input type="text" id="codigoConductor" placeholder="Ingrese el código del conductor">  
    <button id="btnEnviar">Enviar Código</button>  
  </div>  

  <script>  
    // Registrar el Service Worker  
    if ("serviceWorker" in navigator) {  
      navigator.serviceWorker.register("./ws.js")  
        .then(() => console.log("Service Worker registrado correctamente."))  
        .catch((error) => console.error("Error al registrar el Service Worker:", error));  
    }  

    // Iniciar la obtención de la ubicación  
    function iniciarUbicacion() {  
      if ("serviceWorker" in navigator && navigator.serviceWorker.controller) {  
        navigator.serviceWorker.controller.postMessage("iniciar");  
      }  
    }  

    // Detener la obtención de la ubicación  
    function detenerUbicacion() {  
      if ("serviceWorker" in navigator && navigator.serviceWorker.controller) {  
        navigator.serviceWorker.controller.postMessage("detener");  
      }  
    }  

    // Función para obtener el nombre del chofer  
    function obtenerNombreConductor(codigo) {  
      const url = "https://script.google.com/macros/s/AKfycbx_kg6MTahza8LJ6USXH6DMk15cE19U39IeNuXgslHdQL5zGqiW-5FIBt6gjYLumz8txg/exec?codigo=" + codigo;  

      fetch(url)  
        .then(response => response.json())  
        .then(data => {  
          if (data.nombre) {  
            document.getElementById("nombreChofer").innerText = "Chofer: " + data.nombre;  
            iniciarUbicacion(); // Iniciar la ubicación después de obtener el nombre  
          } else {  
            document.getElementById("mensajeUbicacion").innerText = "Código no encontrado.";  
          }  
        })  
        .catch(error => {  
          console.error("Error al obtener el nombre del conductor:", error);  
          document.getElementById("mensajeUbicacion").innerText = "Error al obtener el nombre del conductor.";  
        });  
    }  

    // Manejar el envío del código del conductor  
    document.getElementById("btnEnviar").addEventListener("click", () => {  
      const codigoConductor = document.getElementById("codigoConductor").value;  
      if (codigoConductor) {  
        obtenerNombreConductor(codigoConductor);  
      }  
    });  
  </script>  
</body>  
</html>  
